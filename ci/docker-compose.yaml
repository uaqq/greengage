x-common-service: &common-service
  image: "${IMAGE}"
  privileged: true
  sysctls:
    kernel.sem: 500 1024000 200 4096
  init: true
  ulimits:
    nofile: 65535
  entrypoint: >
    sleep infinity

x-common-volumes: &common-volumes
  volumes:
    - $PWD/ssh_keys:/home/gpadmin/.ssh

services:
  cdw:
    <<: [*common-service, *common-volumes]
    working_dir: /home/gpadmin
    hostname: cdw
    volumes:
      - "$PWD/allure-results:/tmp/allure-results"
      - "$PWD/logs_cdw:/logs"
  sdw1:
    <<: [*common-service, *common-volumes]
    privileged: true
    hostname: sdw1
    volumes:
      - "$PWD/logs_sdw1:/logs"
  sdw2:
    <<: [*common-service, *common-volumes]
    hostname: sdw2

  sdw3:
    <<: [*common-service, *common-volumes]
    hostname: sdw3

